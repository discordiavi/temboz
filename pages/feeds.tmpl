## -*- html -*-
<html>
<head><title>Temboz - All feeds</title>
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
</head>
<body>
<p class="menu"><a href="/view">All unread</a></p>
#from singleton import db
#import time
#set c = db.cursor()
#silent c.execute("""select feed_uid, feed_title, feed_html, feed_xml,
  julianday('now', 'utc') - max(
    ifnull(
      julianday(item_modified),
      julianday(item_created))),
  sum(case when item_rating=1 then 1 else 0 end) as interesting,
  sum(case when item_rating=0 then 1 else 0 end) as unread,
  sum(case when item_rating=-1 then 1 else 0 end) as uninteresting,
  count(*) as total
from fm_feeds, fm_items
where item_feed_uid=feed_uid
group by feed_uid, feed_title, feed_html, feed_xml
order by interesting DESC, lower(feed_title)""")
<table>
<tr><th>Feed</th><th>Last modified</th><th>Unread</th><th>Interesting</th><th>Hit ratio</th><th>Total</th><th></th></tr>
#for feed_uid, feed_title, feed_html, feed_xml, delta_t, interesting, unread, uninteresting, total in c:
#set since = self.since(delta_t)
#set unread = int(unread)
#set interesting = int(interesting)
#set uninteresting = int(uninteresting)
#set total = int(total)
#silent assert interesting + uninteresting + unread == total, feed_title
<tr><td><a href="$feed_html">$feed_title</a>&nbsp;&nbsp;<a href="$feed_xml">(XML)</a></td><td>$since</td><td><a href="/view?feed_uid=$feed_uid&show=unread">$unread</a></td><td><a href="/view?feed_uid=$feed_uid&show=up">$interesting</a></td><td><%=interesting*100/total%>%</td><td><a href="/view?feed_uid=$feed_uid&show=all">$total</a></td><td>
#if unread > 0:
<a href="/catch_up?feed_uid=$feed_uid">catch up</a>
#end if
</td></tr>
#end for
#silent db.commit()
#silent c.close()
</table>
</body></html>
